import{r as g,j as t}from"./jsx-runtime-BMrMXMSG.js";import{u as E}from"./useNavigateSubmit-CcxL25EO.js";import{G as j,a as S,b as a,L as F}from"./constants-PTFKni65.js";import{I as L}from"./contentStepInputs-MXs24Sf4.js";import{u as k,a as A}from"./index-X6hTWa2L.js";import{u as G,a as O,F as H}from"./components-HnT9RUCx.js";import{S as M}from"./SkeletonPage-De1vAtof.js";import{B as r,T as d}from"./BlockStack-CwgU8ZDe.js";import{B as N}from"./Banner-ByLDynuR.js";import{L as u}from"./Layout-BYdFqsmV.js";import{C as I}from"./Card-ZEVPeMCa.js";import{D as P}from"./Divider-BzciHtgk.js";import{B as p}from"./use-toggle-Eq3DVTD9.js";import{T as v}from"./TextField-BeUUpecL.js";import{B as W}from"./Box-rytM3cuw.js";import{B as V}from"./ButtonGroup-CD4h0o06.js";import"./index-qcftwevc.js";import"./InlineStack-BZy780dy.js";import"./DeleteIcon.svg-BsxW9olQ.js";import"./InlineGrid-CSxQjylE.js";import"./Select-DopI2RBP.js";import"./Icon-C8tnHXot.js";import"./context-DYc23ASG.js";import"./ChoiceList-D6-7UDXf.js";import"./Bleed-CojZzunP.js";import"./within-content-context-B9v2rWOt.js";import"./use-event-listener-CxlhjZIg.js";import"./use-is-after-initial-mount-2owk6l5Z.js";import"./EventListener-kZJ1rsuP.js";function jt(){const m=k(),h=m.state==="loading",y=m.state==="submitting",C=E(),b=A(),x=G(),T=x?.data,i=x?.errors,B=O().data,[s,o]=g.useState(i?.length===0||!i?B:T),w=e=>{o(n=>({...n,contentInputs:n.contentInput.map(l=>l.id===e.id?e:l)}))};g.useEffect(()=>{if(i&&i.length===0){window.scrollTo(0,0);return}i?.forEach(e=>{if(e.fieldId){document.getElementById(e.fieldId)?.scrollIntoView();return}})},[i,h]);const c=e=>{i?.forEach(n=>{n.fieldId===e&&(n.message="")})},f=()=>{o(e=>({...e,contentInputs:[...e.contentInput,{id:e.contentInput.length+1,bundleStepId:e.id,inputType:"TEXT",inputLabel:"Enter your name",required:!0,maxChars:100}]}))},D=e=>{o(n=>({...n,contentInputs:n.contentInput.filter(l=>l.id!==e)}))};return t.jsx(t.Fragment,{children:h||y?t.jsx(M,{primaryAction:!0,fullWidth:!0}):t.jsxs(r,{gap:j,children:[i&&i.length===0?t.jsx(N,{title:"Step updated!",tone:"success",onDismiss:()=>{},children:t.jsx(r,{gap:S,children:t.jsx(d,{as:"p",variant:"headingMd",children:"You succesfuly updated this step."})})}):null,t.jsxs(H,{method:"POST","data-discard-confirmation":!0,"data-save-bar":!0,children:[t.jsx("input",{type:"hidden",name:"action",defaultValue:"updateStep"}),t.jsx("input",{type:"hidden",name:"stepData",value:JSON.stringify(s)}),t.jsxs(r,{gap:a,children:[t.jsxs(u,{children:[t.jsx(u.Section,{children:t.jsx(I,{children:t.jsx(r,{gap:F,children:t.jsxs(r,{gap:a,children:[t.jsxs(r,{gap:j,children:[t.jsx(d,{as:"h2",variant:"headingLg",children:"Content step configuration"}),t.jsx(d,{as:"p",variant:"bodyMd",tone:"subdued",children:"On content steps, customers will need to enter content (text, numbers, or images) into the input fields."})]}),t.jsx(r,{gap:a,children:s.contentInput.length>0?t.jsxs(r,{gap:a,children:[s.contentInput.map((e,n)=>t.jsxs(t.Fragment,{children:[t.jsx(L,{removeContentInputField:D,contentInput:e,errors:i,inputId:e.id,index:n+1,updateFieldErrorHandler:c,updateContentInput:w},e.id),s.contentInput.indexOf(e)!==s.contentInput.length-1&&t.jsx(P,{})]})),s.contentInput.length<2&&t.jsx(p,{variant:"primary",fullWidth:!0,onClick:f,children:"Add another input field"})]}):t.jsxs(r,{gap:a,children:[t.jsx(d,{as:"p",children:"There are no content inputs on this step."}),t.jsx(p,{onClick:f,variant:"primary",fullWidth:!0,children:"Add first input field"})]})})]})})})}),t.jsx(u.Section,{variant:"oneThird",children:t.jsx(r,{gap:a,children:t.jsx(I,{children:t.jsxs(r,{gap:S,children:[t.jsx(d,{as:"h2",variant:"headingMd",children:"Step details"}),t.jsx(v,{label:"Step title",error:i?.find(e=>e.fieldId==="stepTitle")?.message,type:"text",name:"stepTitle",value:s.title,helpText:"Customers will see this title when they build a bundle.",onChange:e=>{o(n=>({...n,title:e})),c("stepTitle")},autoComplete:"off"}),t.jsx(v,{label:"Step description",value:s.description,type:"text",name:"stepDescription",helpText:"This description will be displayed to the customer.",onChange:e=>{o(n=>({...n,description:e})),c("stepDESC")},error:i?.find(e=>e.fieldId==="stepDESC")?.message,autoComplete:"off"})]})})})})]}),t.jsx(W,{width:"full",children:t.jsx(r,{inlineAlign:"end",children:t.jsxs(V,{children:[t.jsx(p,{variant:"primary",tone:"critical",onClick:async()=>{await shopify.saveBar.leaveConfirmation(),C("deleteStep",`${b.stepnum}?redirect=true`)},children:"Delete"}),t.jsx(p,{variant:"primary",submit:!0,children:"Save step"})]})})})]})]})]})})}export{jt as default};
