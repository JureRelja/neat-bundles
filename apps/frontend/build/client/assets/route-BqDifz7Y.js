import{r as o,j as e}from"./jsx-runtime-BMrMXMSG.js";import{p as x,_ as b}from"./index-NTrdOwuS.js";import{a as N,b as j}from"./constants-PTFKni65.js";import{u as W,b as M}from"./index-X6hTWa2L.js";import{b as G,a as Y,L as f}from"./components-HnT9RUCx.js";import{u as z}from"./index-qcftwevc.js";import{S as H}from"./SkeletonPage-De1vAtof.js";import{B as d,T as i}from"./BlockStack-CwgU8ZDe.js";import{C as n}from"./Card-ZEVPeMCa.js";import{S as a}from"./SkeletonBodyText-PJLcqbGt.js";import{I as C}from"./InlineStack-BZy780dy.js";import{a as T,B as c}from"./use-toggle-Eq3DVTD9.js";import{B as g}from"./Box-rytM3cuw.js";import{T as O}from"./TextField-BeUUpecL.js";import{S as k,D as R,E as q}from"./EmptyState-DqBpdlXH.js";import{B as D}from"./Badge-SnCWnBbz.js";import{B as J}from"./ButtonGroup-CD4h0o06.js";import{S as K}from"./DeleteIcon.svg-BsxW9olQ.js";import{S as Q}from"./EditIcon.svg-SYyjgaKg.js";import{S as U}from"./ExternalIcon.svg-1Nno8FFk.js";import"./context-DYc23ASG.js";import"./within-content-context-B9v2rWOt.js";import"./Icon-C8tnHXot.js";import"./use-is-after-initial-mount-2owk6l5Z.js";import"./use-event-listener-CxlhjZIg.js";import"./EventListener-kZJ1rsuP.js";import"./context-BqWvd0oi.js";import"./Pagination-Dn9qu2P0.js";const V="_tableWrapper_1tdlw_1",X="_loadingTable_1tdlw_5",Z="_hide_1tdlw_18",y={tableWrapper:V,loadingTable:X,hide:Z};function De(){const v=W(),I=v.state==="loading",_=v.state==="submitting",u=G(),E=z(),L=M(),p=Y(),m=p.data.bundleBuilders,s=p.data.user,F=()=>s.isDevelopmentStore?!0:s.activeBillingPlan==="BASIC"&&m.length>=2?(shopify.modal.show("bundle-limit-modal"),!1):!0,[r,S]=o.useState(),w=()=>{shopify.modal.show("new-bundle-builder-modal")},P=()=>{if(!F())return;if(!r){S("");return}const t=new FormData;t.append("bundleTitle",r),t.append("action","createBundle"),E(t,{method:"POST",action:`/app/users/${s.id}/bundles${s.completedOnboarding?"":"?onboarding=true"}`,navigate:!0})},[l,B]=o.useState(null),[$,h]=o.useState(!1);o.useEffect(()=>{l&&h(!0)},[l]);const A=t=>{L(`/app/edit-bundle-builder/${t}/builder`)};return e.jsx(e.Fragment,{children:I?e.jsx(H,{primaryAction:!0,children:e.jsxs(d,{gap:"500",children:[e.jsx(n,{children:e.jsx(a,{})}),e.jsx(n,{children:e.jsx(a,{})}),e.jsx(n,{children:e.jsx(a,{})}),e.jsx(n,{children:e.jsx(a,{})}),e.jsx(n,{children:e.jsx(a,{})}),e.jsx(n,{children:e.jsx(a,{})})]})}):_?e.jsx(n,{children:e.jsxs(C,{blockAlign:"center",align:"center",gap:N,children:[e.jsx(i,{as:"p",fontWeight:"bold",variant:"headingLg",children:"Your new bundle is being created..."}),e.jsx(T,{accessibilityLabel:"Spinner example",size:"large"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{id:"new-bundle-builder-modal",children:[e.jsx(g,{padding:"300",children:e.jsxs(d,{gap:j,children:[e.jsx(i,{as:"p",variant:"headingSm",children:"Enter the title of your bundle"}),e.jsx(O,{label:"Title",labelHidden:!0,autoComplete:"off",inputMode:"text",name:"bundleTitle",helpText:"This title will be displayed to your customers on the bundle page, in checkout, and in the cart.",value:r,error:r===""?"Please enter a title":void 0,onChange:t=>{S(t)},type:"text"})]})}),e.jsx(b,{title:"Bundle title",children:e.jsx("button",{variant:"primary",onClick:P,disabled:u.state!=="idle",children:"Next"})})]}),e.jsxs(x,{id:"delete-confirm-modal",open:$,children:[e.jsx(g,{padding:"300",children:e.jsx(i,{as:"p",children:"If you delete this bundle, everything will be lost forever."})}),e.jsxs(b,{title:"Are you sure you want to delete this bundle?",children:[e.jsx("button",{onClick:()=>h(!1),children:"Close"}),e.jsx("button",{variant:"primary",tone:"critical",onClick:()=>{if(!l)return;const t=new FormData;t.append("action","deleteBundle"),u.submit(t,{method:"post",action:`/app/edit-bundle-builder/${l.id}/builder`}),B(null),h(!1)},children:"Delete"})]})]}),e.jsxs(x,{id:"bundle-limit-modal",children:[e.jsx(g,{padding:"300",children:e.jsxs(d,{gap:j,children:[e.jsx(i,{as:"p",children:"You are on the 'Basic' plan which only allows you to have up to 2 bundles at one time."}),e.jsxs(i,{as:"p",variant:"headingSm",children:["If you want to create more bundles, go to ",e.jsx(f,{to:"/app/billing",children:"billing"})," and upgrade to paid plan."]})]})}),e.jsx(b,{title:"Maximum bundles reached",children:e.jsx("button",{variant:"primary",onClick:()=>shopify.modal.hide("bundle-limit-modal"),children:"Close"})})]}),e.jsxs(d,{gap:j,children:[e.jsxs(C,{align:"space-between",children:[e.jsx(i,{as:"h3",variant:"headingLg",children:"My Bundles"}),e.jsx(c,{icon:k,variant:"primary",onClick:w,children:"Create bundle"})]}),e.jsxs("div",{id:y.tableWrapper,children:[e.jsx("div",{className:u.state!=="idle"?y.loadingTable:y.hide,children:e.jsx(T,{accessibilityLabel:"Spinner example",size:"large"})}),e.jsx(n,{children:m.length>0?e.jsx(R,{columnContentTypes:["text","text","text","text","text"],headings:["Bundle ID","Name","Status","Actions","Preview"],rows:m.map(t=>[e.jsx(i,{as:"p",tone:"base",children:t.id}),e.jsx(f,{to:"#",onClick:()=>{A(t.id)},children:e.jsx(i,{as:"p",tone:"base",children:t.title})}),e.jsx(f,{to:`/app/edit-bundle-builder/${t.id}/builder`,children:t.published?e.jsx(D,{tone:"success",children:"Active"}):e.jsx(D,{tone:"info",children:"Draft"})}),e.jsxs(J,{children:[e.jsx(c,{icon:K,variant:"secondary",tone:"critical",onClick:()=>{B(t)},children:"Delete"}),e.jsx(c,{icon:Q,variant:"primary",url:`/app/edit-bundle-builder/${t.id}/builder`,children:"Edit"})]}),e.jsx(c,{icon:U,variant:"secondary",tone:"success",url:`${p.data.userPrimaryDomain}/apps/nb/widgets/${t.id}`,target:"_blank",children:"Preview"})])}):e.jsx(q,{heading:"Letâ€™s create the first custom bundle for your customers!",action:{content:"Create bundle",icon:k,onAction:w},fullWidth:!0,image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Your customers will be able to use the custom bundles you create to create and buy their own custom bundles."})})})]})]})]})})}export{De as default};
