import{r as g,j as t}from"./jsx-runtime-BMrMXMSG.js";import{u as E}from"./useNavigateSubmit-CTqj78J6.js";import{G as j,a as S,b as a,L as F}from"./constants-xrzLx32Y.js";import{I as L}from"./contentStepInputs-DCJJSpa0.js";import{u as k,a as A}from"./index-dL4ND7l9.js";import{u as G,a as O}from"./components-BDrsBlv3.js";import{S as H}from"./SkeletonPage-oS14FYNy.js";import{B as r,T as d}from"./BlockStack-CBC_PXe6.js";import{B as M}from"./Banner-DrpU63xa.js";import{F as N}from"./index-y3bcNOgC.js";import{L as u}from"./Layout-CMntMX4Q.js";import{C as I}from"./Card-DdP2um4p.js";import{D as P}from"./Divider-BzciHtgk.js";import{B as p}from"./use-toggle-Bx-o2WPs.js";import{T as v}from"./TextField-B-Nm0VLF.js";import{B as W}from"./Box-CnqJGKrn.js";import{B as V}from"./ButtonGroup-GOmEL2FH.js";import"./InlineStack-BYbsxF_T.js";import"./DeleteIcon.svg-BsxW9olQ.js";import"./InlineGrid-Df5BtU4c.js";import"./Select-Cif7Qcy3.js";import"./Icon-C-cZWGQM.js";import"./context-C-JwoyEZ.js";import"./ChoiceList-Dt5iyaoi.js";import"./Bleed-DpULRbVU.js";import"./within-content-context-B9v2rWOt.js";import"./use-event-listener-DOg0fKDs.js";import"./use-is-after-initial-mount-DPsAqfZs.js";import"./EventListener-kZJ1rsuP.js";function jt(){const m=k(),h=m.state==="loading",y=m.state==="submitting",C=E(),b=A(),x=G(),T=x?.data,i=x?.errors,B=O().data,[s,o]=g.useState(i?.length===0||!i?B:T),w=e=>{o(n=>({...n,contentInputs:n.contentInputs.map(l=>l.id===e.id?e:l)}))};g.useEffect(()=>{if(i&&i.length===0){window.scrollTo(0,0);return}i?.forEach(e=>{if(e.fieldId){document.getElementById(e.fieldId)?.scrollIntoView();return}})},[i,h]);const c=e=>{i?.forEach(n=>{n.fieldId===e&&(n.message="")})},f=()=>{o(e=>({...e,contentInputs:[...e.contentInputs,{id:e.contentInputs.length+1,bundleStepId:e.id,inputType:"TEXT",inputLabel:"Enter your name",required:!0,maxChars:100}]}))},D=e=>{o(n=>({...n,contentInputs:n.contentInputs.filter(l=>l.id!==e)}))};return t.jsx(t.Fragment,{children:h||y?t.jsx(H,{primaryAction:!0,fullWidth:!0}):t.jsxs(r,{gap:j,children:[i&&i.length===0?t.jsx(M,{title:"Step updated!",tone:"success",onDismiss:()=>{},children:t.jsx(r,{gap:S,children:t.jsx(d,{as:"p",variant:"headingMd",children:"You succesfuly updated this step."})})}):null,t.jsxs(N,{method:"POST","data-discard-confirmation":!0,"data-save-bar":!0,children:[t.jsx("input",{type:"hidden",name:"action",defaultValue:"updateStep"}),t.jsx("input",{type:"hidden",name:"stepData",value:JSON.stringify(s)}),t.jsxs(r,{gap:a,children:[t.jsxs(u,{children:[t.jsx(u.Section,{children:t.jsx(I,{children:t.jsx(r,{gap:F,children:t.jsxs(r,{gap:a,children:[t.jsxs(r,{gap:j,children:[t.jsx(d,{as:"h2",variant:"headingLg",children:"Content step configuration"}),t.jsx(d,{as:"p",variant:"bodyMd",tone:"subdued",children:"On content steps, customers will need to enter content (text, numbers, or images) into the input fields."})]}),t.jsx(r,{gap:a,children:s.contentInputs.length>0?t.jsxs(r,{gap:a,children:[s.contentInputs.map((e,n)=>t.jsxs(t.Fragment,{children:[t.jsx(L,{removeContentInputField:D,contentInput:e,errors:i,inputId:e.id,index:n+1,updateFieldErrorHandler:c,updateContentInput:w},e.id),s.contentInputs.indexOf(e)!==s.contentInputs.length-1&&t.jsx(P,{})]})),s.contentInputs.length<2&&t.jsx(p,{variant:"primary",fullWidth:!0,onClick:f,children:"Add another input field"})]}):t.jsxs(r,{gap:a,children:[t.jsx(d,{as:"p",children:"There are no content inputs on this step."}),t.jsx(p,{onClick:f,variant:"primary",fullWidth:!0,children:"Add first input field"})]})})]})})})}),t.jsx(u.Section,{variant:"oneThird",children:t.jsx(r,{gap:a,children:t.jsx(I,{children:t.jsxs(r,{gap:S,children:[t.jsx(d,{as:"h2",variant:"headingMd",children:"Step details"}),t.jsx(v,{label:"Step title",error:i?.find(e=>e.fieldId==="stepTitle")?.message,type:"text",name:"stepTitle",value:s.title,helpText:"Customers will see this title when they build a bundle.",onChange:e=>{o(n=>({...n,title:e})),c("stepTitle")},autoComplete:"off"}),t.jsx(v,{label:"Step description",value:s.description,type:"text",name:"stepDescription",helpText:"This description will be displayed to the customer.",onChange:e=>{o(n=>({...n,description:e})),c("stepDESC")},error:i?.find(e=>e.fieldId==="stepDESC")?.message,autoComplete:"off"})]})})})})]}),t.jsx(W,{width:"full",children:t.jsx(r,{inlineAlign:"end",children:t.jsxs(V,{children:[t.jsx(p,{variant:"primary",tone:"critical",onClick:async()=>{await shopify.saveBar.leaveConfirmation(),C("deleteStep",`${b.stepnum}?redirect=true`)},children:"Delete"}),t.jsx(p,{variant:"primary",submit:!0,children:"Save step"})]})})})]})]})]})})}export{jt as default};
