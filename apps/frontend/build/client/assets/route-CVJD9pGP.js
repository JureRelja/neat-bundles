import{r as d,j as e}from"./jsx-runtime-BMrMXMSG.js";import{p as h,_ as x}from"./index-BdEiwQAR.js";import{a as N,b,d as W}from"./constants-xrzLx32Y.js";import{u as M,b as G}from"./index-dL4ND7l9.js";import{b as Y,a as z,L as g}from"./components-BDrsBlv3.js";import{u as H}from"./index-y3bcNOgC.js";import{S as O}from"./SkeletonPage-oS14FYNy.js";import{B as c,T as i}from"./BlockStack-CBC_PXe6.js";import{C as n}from"./Card-DdP2um4p.js";import{S as s}from"./SkeletonBodyText-PJLcqbGt.js";import{I as C}from"./InlineStack-BYbsxF_T.js";import{a as T,B as a}from"./use-toggle-Bx-o2WPs.js";import{B as j}from"./Box-CnqJGKrn.js";import{T as R}from"./TextField-B-Nm0VLF.js";import{S as k,D as U,a as K,E as q}from"./EmptyState-Bdvqmiml.js";import{B as D}from"./Badge-PSuHbHll.js";import{B as J}from"./ButtonGroup-GOmEL2FH.js";import{S as Q}from"./DeleteIcon.svg-BsxW9olQ.js";import{S as V}from"./EditIcon.svg-SYyjgaKg.js";import{S as X}from"./ExternalIcon.svg-1Nno8FFk.js";import"./context-C-JwoyEZ.js";import"./within-content-context-B9v2rWOt.js";import"./Icon-C-cZWGQM.js";import"./use-is-after-initial-mount-DPsAqfZs.js";import"./use-event-listener-DOg0fKDs.js";import"./EventListener-kZJ1rsuP.js";import"./context-g-r66Qxo.js";import"./Pagination-B_BjUQTQ.js";const Z="_tableWrapper_1tdlw_1",ee="_loadingTable_1tdlw_5",te="_hide_1tdlw_18",f={tableWrapper:Z,loadingTable:ee,hide:te};function _e(){const S=M(),I=S.state==="loading",_=S.state==="submitting",u=Y(),P=H(),E=G(),y=z(),p=y.data.bundleBuildersWithPageUrl,r=y.data.user,$=()=>r.isDevelopmentStore?!0:r.activeBillingPlan==="BASIC"&&p.length>=2?(shopify.modal.show("bundle-limit-modal"),!1):!0,[l,v]=d.useState(),w=()=>{shopify.modal.show("new-bundle-builder-modal")},L=()=>{if(!$())return;if(!l){v("");return}const t=new FormData;t.append("bundleTitle",l),t.append("action","createBundle"),P(t,{method:"POST",action:`/app/users/${r.id}/bundles${r.completedOnboarding?"":"?onboarding=true"}`,navigate:!0})},[o,B]=d.useState(null),[F,m]=d.useState(!1);d.useEffect(()=>{o&&m(!0)},[o]);const A=t=>{E(`/app/edit-bundle-builder/${t}/builder`)};return e.jsx(e.Fragment,{children:I?e.jsx(O,{primaryAction:!0,children:e.jsxs(c,{gap:"500",children:[e.jsx(n,{children:e.jsx(s,{})}),e.jsx(n,{children:e.jsx(s,{})}),e.jsx(n,{children:e.jsx(s,{})}),e.jsx(n,{children:e.jsx(s,{})}),e.jsx(n,{children:e.jsx(s,{})}),e.jsx(n,{children:e.jsx(s,{})})]})}):_?e.jsx(n,{children:e.jsxs(C,{blockAlign:"center",align:"center",gap:N,children:[e.jsx(i,{as:"p",fontWeight:"bold",variant:"headingLg",children:"Your new bundle is being created..."}),e.jsx(T,{accessibilityLabel:"Spinner example",size:"large"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{id:"new-bundle-builder-modal",children:[e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:b,children:[e.jsx(i,{as:"p",variant:"headingSm",children:"Enter the title of your bundle"}),e.jsx(R,{label:"Title",labelHidden:!0,autoComplete:"off",inputMode:"text",name:"bundleTitle",helpText:"This title will be displayed to your customers on the bundle page, in checkout, and in the cart.",value:l,error:l===""?"Please enter a title":void 0,onChange:t=>{v(t)},type:"text"})]})}),e.jsx(x,{title:"Bundle title",children:e.jsx("button",{variant:"primary",onClick:L,disabled:u.state!=="idle",children:"Next"})})]}),e.jsxs(h,{id:"delete-confirm-modal",open:F,children:[e.jsx(j,{padding:"300",children:e.jsx(i,{as:"p",children:"If you delete this bundle, everything will be lost forever."})}),e.jsxs(x,{title:"Are you sure you want to delete this bundle?",children:[e.jsx("button",{onClick:()=>m(!1),children:"Close"}),e.jsx("button",{variant:"primary",tone:"critical",onClick:()=>{if(!o)return;const t=new FormData;t.append("action","deleteBundle"),u.submit(t,{method:"post",action:`/app/edit-bundle-builder/${o.id}/builder`}),B(null),m(!1)},children:"Delete"})]})]}),e.jsxs(h,{id:"bundle-limit-modal",children:[e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:b,children:[e.jsx(i,{as:"p",children:"You are on the 'Basic' plan which only allows you to have up to 2 bundles at one time."}),e.jsxs(i,{as:"p",variant:"headingSm",children:["If you want to create more bundles, go to ",e.jsx(g,{to:"/app/billing",children:"billing"})," and upgrade to paid plan."]})]})}),e.jsx(x,{title:"Maximum bundles reached",children:e.jsx("button",{variant:"primary",onClick:()=>shopify.modal.hide("bundle-limit-modal"),children:"Close"})})]}),e.jsxs(c,{gap:b,children:[e.jsxs(C,{align:"space-between",children:[e.jsx(i,{as:"h3",variant:"headingLg",children:"My Bundles"}),e.jsx(a,{icon:k,variant:"primary",onClick:w,children:"Create bundle"})]}),e.jsxs("div",{id:f.tableWrapper,children:[e.jsx("div",{className:u.state!=="idle"?f.loadingTable:f.hide,children:e.jsx(T,{accessibilityLabel:"Spinner example",size:"large"})}),e.jsx(n,{children:p.length>0?e.jsx(U,{columnContentTypes:["text","text","text","text","text","text"],headings:["Bundle ID","Name","Steps","Status","Actions","Settings","Preview"],rows:p.map(t=>[e.jsx(i,{as:"p",tone:"base",children:t.id}),e.jsx(g,{to:"#",onClick:()=>{A(t.id)},children:e.jsx(i,{as:"p",tone:"base",children:t.title})}),t.steps.length,e.jsx(g,{to:`/app/edit-bundle-builder/${t.id}/builder`,children:t.published?e.jsx(D,{tone:"success",children:"Active"}):e.jsx(D,{tone:"info",children:"Draft"})}),e.jsxs(J,{children:[e.jsx(a,{icon:Q,variant:"secondary",tone:"critical",onClick:()=>{B(t)},children:"Delete"}),e.jsx(a,{icon:V,variant:"primary",url:`/app/edit-bundle-builder/${t.id}/builder`,children:"Edit"})]}),e.jsx(a,{icon:K,variant:"secondary",tone:"success",url:`/app/edit-bundle-builder/${t.id}/settings/?redirect=/app/edit-bundle-builder/${t.id}/builder`,children:"Settings"}),e.jsx(a,{icon:X,variant:"secondary",tone:"success",url:`${t.bundleBuilderPageUrl}?${W}=true`,target:"_blank",children:"Preview"})])}):e.jsx(q,{heading:"Letâ€™s create the first custom bundle for your customers!",action:{content:"Create bundle",icon:k,onAction:w},fullWidth:!0,image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Your customers will be able to use the custom bundles you create to create and buy their own custom bundles."})})})]})]})]})})}export{_e as default};
