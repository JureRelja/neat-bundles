import{r as g}from"./jsx-runtime-BMrMXMSG.js";import{t as A,s as M,b as D}from"./context-DYc23ASG.js";import{s as H,d as Y}from"./use-is-after-initial-mount-2owk6l5Z.js";const q=g.createContext(null),$=g.createContext(null);function Q(s){return A[s]}function U(){const s=g.useContext(q);if(!s)throw new Error("No theme was provided. Your application must be wrapped in an <AppProvider> or <ThemeProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return s}function V(){const s=g.useContext($);if(!s)throw new Error("No themeName was provided. Your application must be wrapped in an <AppProvider> or <ThemeProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return s}function b(s,t,n){let e,o,c,a,r,u,d=0,k=!1,h=!1,w=!0;const S=!t&&t!==0;if(typeof s!="function")throw new TypeError("Expected a function");const f=t||0;typeof n=="object"&&(k=!!n.leading,h="maxWait"in n,c=h?Math.max(Number(n.maxWait)||0,f):void 0,w="trailing"in n?!!n.trailing:w);function m(i){const l=e,p=o;return e=void 0,o=void 0,d=i,a=s.apply(p,l),a}function I(i,l){return S?(cancelAnimationFrame(r),requestAnimationFrame(i)):setTimeout(i,l)}function E(i){if(S)return cancelAnimationFrame(i);clearTimeout(i)}function P(i){return d=i,r=I(y,f),k?m(i):a}function O(i){const l=i-u,p=i-d,B=f-l;return h&&c?Math.min(B,c-p):B}function N(i){const l=i-u,p=i-d;return u===void 0||l>=f||l<0||h&&c&&p>=c}function y(){const i=Date.now();if(N(i))return R(i);r=I(y,O(i))}function R(i){return r=void 0,w&&e?m(i):(e=o=void 0,a)}function F(){r!==void 0&&E(r),d=0,e=u=o=r=void 0}function W(){return r===void 0?a:R(Date.now())}function z(){return r!==void 0}function x(...i){const l=Date.now(),p=N(l);if(e=i,o=this,u=l,p){if(r===void 0)return P(u);if(h)return r=I(y,f),m(u)}return r===void 0&&(r=I(y,f)),a}return x.cancel=F,x.flush=W,x.pending=z,x}class T{static get zero(){return new T}constructor({top:t=0,left:n=0,width:e=0,height:o=0}={}){this.top=t,this.left=n,this.width=e,this.height=o}get center(){return{x:this.left+this.width/2,y:this.top+this.height/2}}}function v(s){if(!(s instanceof Element))return new T({width:window.innerWidth,height:window.innerHeight});const t=s.getBoundingClientRect();return new T({top:t.top,left:t.left,width:t.width,height:t.height})}const C=1e3/60;class Z{constructor(t){this.stickyItems=[],this.stuckItems=[],this.container=null,this.topBarOffset=0,this.handleResize=b(()=>{this.manageStickyItems()},C,{leading:!0,trailing:!0,maxWait:C}),this.handleScroll=b(()=>{this.manageStickyItems()},C,{leading:!0,trailing:!0,maxWait:C}),t&&this.setContainer(t)}registerStickyItem(t){this.stickyItems.push(t)}unregisterStickyItem(t){const n=this.stickyItems.findIndex(({stickyNode:e})=>t===e);this.stickyItems.splice(n,1)}setContainer(t){this.container=t,L(t)&&this.setTopBarOffset(t),this.container.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize),this.manageStickyItems()}removeScrollListener(){this.container&&(this.container.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize))}manageStickyItems(){if(this.stickyItems.length<=0)return;const t=this.container?j(this.container):0,n=v(this.container).top+this.topBarOffset;this.stickyItems.forEach(e=>{const{handlePositioning:o}=e,{sticky:c,top:a,left:r,width:u}=this.evaluateStickyItem(e,t,n);this.updateStuckItems(e,c),o(c,a,r,u)})}evaluateStickyItem(t,n,e){const{stickyNode:o,placeHolderNode:c,boundingElement:a,offset:r,disableWhenStacked:u}=t;if(u&&M().matches)return{sticky:!1,top:0,left:0,width:"auto"};const d=r?this.getOffset(o)+parseInt(D.space["space-500"],10):this.getOffset(o),k=n+d,h=c.getBoundingClientRect().top-e+n,w=e+d,S=c.getBoundingClientRect().width,f=c.getBoundingClientRect().left;let m;if(a==null)m=k>=h;else{const I=o.getBoundingClientRect().height||o.firstElementChild?.getBoundingClientRect().height||0,E=a.getBoundingClientRect().bottom-I+n-e;m=k>=h&&k<E}return{sticky:m,top:w,left:f,width:S}}updateStuckItems(t,n){const{stickyNode:e}=t;n&&!this.isNodeStuck(e)?this.addStuckItem(t):!n&&this.isNodeStuck(e)&&this.removeStuckItem(t)}addStuckItem(t){this.stuckItems.push(t)}removeStuckItem(t){const{stickyNode:n}=t,e=this.stuckItems.findIndex(({stickyNode:o})=>n===o);this.stuckItems.splice(e,1)}getOffset(t){if(this.stuckItems.length===0)return 0;let n=0,e=0;const o=this.stuckItems.length,c=v(t);for(;e<o;){const a=this.stuckItems[e].stickyNode;if(a!==t){const r=v(a);X(c,r)||(n+=v(a).height)}else break;e++}return n}isNodeStuck(t){return this.stuckItems.findIndex(({stickyNode:e})=>t===e)>=0}setTopBarOffset(t){const n=t.querySelector(`:not(${H.selector}) ${Y.selector}`);this.topBarOffset=n?n.clientHeight:0}}function L(s){return s===document}function j(s){return L(s)?document.body.scrollTop||document.documentElement.scrollTop:s.scrollTop}function X(s,t){const n=s.left,e=s.left+s.width,o=t.left;return t.left+t.width<n||e<o}const _=g.createContext(void 0),tt=g.createContext(void 0),et=g.createContext(void 0);export{et as E,tt as P,T as R,_ as S,$ as T,Z as a,q as b,Q as c,b as d,U as e,v as g,V as u};
